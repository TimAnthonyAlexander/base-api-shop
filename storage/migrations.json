{
    "version": "1.0",
    "migrations": [
        {
            "id": "mig_04257903c246",
            "sql": "CREATE TABLE `api_token` (\n  `user_id` VARCHAR(36) NOT NULL DEFAULT '',\n  `name` TEXT NOT NULL,\n  `token_hash` TEXT NOT NULL,\n  `expires_at` TEXT,\n  `last_used_at` TEXT,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "api_token",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_3a840229cbbb",
            "sql": "CREATE TABLE `basket` (\n  `user_id` VARCHAR(36) NOT NULL,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "basket",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_4194d87f483c",
            "sql": "CREATE TABLE `basket_item` (\n  `basket_id` VARCHAR(36) NOT NULL,\n  `product_id` VARCHAR(36) NOT NULL,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "basket_item",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_a315ce5235bf",
            "sql": "CREATE TABLE `product` (\n  `title` VARCHAR(255) NOT NULL,\n  `description` VARCHAR(255),\n  `price` DOUBLE NOT NULL DEFAULT '0',\n  `stock` INT NOT NULL DEFAULT '0',\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "product",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_8cdea61fbb9e",
            "sql": "CREATE TABLE `product_image` (\n  `product_id` VARCHAR(36) NOT NULL,\n  `image_path` VARCHAR(255) NOT NULL,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "product_image",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_9112a3118702",
            "sql": "CREATE TABLE `user` (\n  `name` VARCHAR(255) NOT NULL DEFAULT '',\n  `password` VARCHAR(255) NOT NULL DEFAULT '',\n  `email` VARCHAR(255) NOT NULL DEFAULT '',\n  `active` TINYINT(1) NOT NULL DEFAULT '1',\n  `address` VARCHAR(255) NOT NULL DEFAULT '',\n  `role` VARCHAR(255) NOT NULL DEFAULT 'user',\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "user",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_6b14df9e082e",
            "sql": "ALTER TABLE `api_token` ADD UNIQUE KEY `uniq_api_token_token_hash` (`token_hash`(191))",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "api_token",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_215286bab9cc",
            "sql": "ALTER TABLE `api_token` ADD INDEX `idx_api_token_user_id` (`user_id`)",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "api_token",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_6afc434b63eb",
            "sql": "ALTER TABLE `product` ADD INDEX `idx_product_title` (`title`)",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "product",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_2b23f0abdfc8",
            "sql": "ALTER TABLE `product` ADD INDEX `idx_product_price` (`price`)",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "product",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_eb324a971027",
            "sql": "ALTER TABLE `user` ADD UNIQUE KEY `uniq_user_email` (`email`)",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "user",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_ea1755b9d68e",
            "sql": "ALTER TABLE `user` ADD INDEX `idx_user_role` (`role`)",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "user",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_8e7c8c6dc3fe",
            "sql": "ALTER TABLE `api_token` ADD CONSTRAINT `fk_api_token_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "api_token",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_35bf5d2fe887",
            "sql": "ALTER TABLE `basket` ADD CONSTRAINT `fk_basket_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "basket",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_1db5ebad078d",
            "sql": "ALTER TABLE `basket_item` ADD CONSTRAINT `fk_basket_item_basket_id` FOREIGN KEY (`basket_id`) REFERENCES `basket` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "basket_item",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_7a0d12911124",
            "sql": "ALTER TABLE `basket_item` ADD CONSTRAINT `fk_basket_item_product_id` FOREIGN KEY (`product_id`) REFERENCES `product` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "basket_item",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_9ced15a330d4",
            "sql": "ALTER TABLE `product_image` ADD CONSTRAINT `fk_product_image_product_id` FOREIGN KEY (`product_id`) REFERENCES `product` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T18:46:26+00:00",
            "table": "product_image",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_fc4e24b5b25b",
            "sql": "CREATE TABLE `jobs` (\n    `id` VARCHAR(36) NOT NULL PRIMARY KEY,\n    `queue` VARCHAR(255) NOT NULL DEFAULT 'default',\n    `payload` TEXT NOT NULL,\n    `status` VARCHAR(50) NOT NULL DEFAULT 'pending',\n    `attempts` INT NOT NULL DEFAULT 0,\n    `error` TEXT,\n    `run_at` DATETIME NOT NULL,\n    `started_at` DATETIME,\n    `completed_at` DATETIME,\n    `failed_at` DATETIME,\n    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n\n-- Create essential indexes for queue performance\nCREATE INDEX jobs_queue_status_run_at_index ON jobs (queue, status, run_at);\nCREATE INDEX jobs_status_run_at_index ON jobs (status, run_at);\nCREATE INDEX jobs_status_index ON jobs (status);",
            "destructive": false,
            "generated_at": "2025-10-02T18:47:02+00:00",
            "table": "jobs",
            "operation": "create_table",
            "description": "Create jobs table and indexes for queue system"
        },
        {
            "id": "mig_a9ea42066e77",
            "sql": "ALTER TABLE `basket_item` ADD COLUMN `quantity` INT NOT NULL DEFAULT '1'",
            "destructive": false,
            "generated_at": "2025-10-02T19:28:07+00:00",
            "table": "basket_item",
            "operation": "add_column",
            "warning": null
        },
        {
            "id": "mig_cfa835f979d6",
            "sql": "CREATE TABLE `order` (\n  `user_id` VARCHAR(36) NOT NULL,\n  `status` VARCHAR(255) NOT NULL,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_a0a440198f44",
            "sql": "CREATE TABLE `order_item` (\n  `order_id` VARCHAR(36) NOT NULL,\n  `product_id` VARCHAR(36) NOT NULL,\n  `quantity` INT NOT NULL DEFAULT '1',\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order_item",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_1f34ebcf913f",
            "sql": "ALTER TABLE `order` ADD INDEX `idx_order_user_id` (`user_id`)",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_03a01dc4fbe8",
            "sql": "ALTER TABLE `order` ADD INDEX `idx_order_status` (`status`)",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_bc317eb42300",
            "sql": "ALTER TABLE `order_item` ADD INDEX `idx_order_item_order_id` (`order_id`)",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order_item",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_cb1921af8e3f",
            "sql": "ALTER TABLE `order_item` ADD INDEX `idx_order_item_product_id` (`product_id`)",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order_item",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_92db27ca9c80",
            "sql": "ALTER TABLE `order` ADD CONSTRAINT `fk_order_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_5a2dac36e4e7",
            "sql": "ALTER TABLE `order_item` ADD CONSTRAINT `fk_order_item_order_id` FOREIGN KEY (`order_id`) REFERENCES `order` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order_item",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_1a8bd3e6c6f3",
            "sql": "ALTER TABLE `order_item` ADD CONSTRAINT `fk_order_item_product_id` FOREIGN KEY (`product_id`) REFERENCES `product` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-02T19:44:34+00:00",
            "table": "order_item",
            "operation": "add_fk",
            "warning": null
        },
        {
            "id": "mig_d02b6d97be06",
            "sql": "ALTER TABLE `basket` ADD COLUMN `stripe_checkout` VARCHAR(255)",
            "destructive": false,
            "generated_at": "2025-10-02T21:54:45+00:00",
            "table": "basket",
            "operation": "add_column",
            "warning": null
        },
        {
            "id": "mig_e5d1add4c1cc",
            "sql": "ALTER TABLE `basket` MODIFY COLUMN `stripe_checkout` TEXT",
            "destructive": false,
            "generated_at": "2025-10-02T22:02:15+00:00",
            "table": "basket",
            "operation": "modify_column",
            "warning": null
        },
        {
            "id": "mig_05a992e77b90",
            "sql": "ALTER TABLE `product` ADD COLUMN `views` INT NOT NULL DEFAULT '0'",
            "destructive": false,
            "generated_at": "2025-10-03T09:11:59+00:00",
            "table": "product",
            "operation": "add_column",
            "warning": null
        },
        {
            "id": "mig_f5da0a843385",
            "sql": "ALTER TABLE `product` ADD INDEX `idx_product_stock` (`stock`)",
            "destructive": false,
            "generated_at": "2025-10-03T09:11:59+00:00",
            "table": "product",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_caa116523f39",
            "sql": "ALTER TABLE `product` ADD INDEX `idx_product_views` (`views`)",
            "destructive": false,
            "generated_at": "2025-10-03T09:11:59+00:00",
            "table": "product",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_ea8f7ce2754e",
            "sql": "ALTER TABLE `product` MODIFY COLUMN `description` TEXT",
            "destructive": false,
            "generated_at": "2025-10-03T10:03:42+00:00",
            "table": "product",
            "operation": "modify_column",
            "warning": null
        },
        {
            "id": "mig_529f7a44d110",
            "sql": "CREATE TABLE `setting` (\n  `key` VARCHAR(255) NOT NULL DEFAULT '',\n  `value` VARCHAR(255) NOT NULL DEFAULT '',\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-03T10:26:33+00:00",
            "table": "setting",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_820aa3ee02c9",
            "sql": "ALTER TABLE `setting` ADD UNIQUE KEY `uniq_setting_key` (`key`)",
            "destructive": false,
            "generated_at": "2025-10-03T10:26:33+00:00",
            "table": "setting",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_2463a576c040",
            "sql": "ALTER TABLE `order` ADD COLUMN `total_price` DOUBLE NOT NULL DEFAULT '0'",
            "destructive": false,
            "generated_at": "2025-10-03T13:58:57+00:00",
            "table": "order",
            "operation": "add_column",
            "warning": null
        },
        {
            "id": "mig_23b8512a6751",
            "sql": "ALTER TABLE `order_item` ADD COLUMN `price` DOUBLE NOT NULL DEFAULT '0'",
            "destructive": false,
            "generated_at": "2025-10-03T13:58:57+00:00",
            "table": "order_item",
            "operation": "add_column",
            "warning": null
        },
        {
            "id": "mig_7eea744cb2d0",
            "sql": "CREATE TABLE `product_attribute` (\n  `product_id` VARCHAR(36) NOT NULL,\n  `attribute` VARCHAR(255) NOT NULL,\n  `value` TEXT NOT NULL,\n  `id` VARCHAR(36) NOT NULL DEFAULT '',\n  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci",
            "destructive": false,
            "generated_at": "2025-10-03T15:29:50+00:00",
            "table": "product_attribute",
            "operation": "create_table",
            "warning": null
        },
        {
            "id": "mig_c02d9a6774e3",
            "sql": "ALTER TABLE `product_attribute` ADD INDEX `idx_product_attribute_product_id` (`product_id`)",
            "destructive": false,
            "generated_at": "2025-10-03T15:29:50+00:00",
            "table": "product_attribute",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_d0ae6b824c58",
            "sql": "ALTER TABLE `product_attribute` ADD INDEX `idx_product_attribute_attribute` (`attribute`)",
            "destructive": false,
            "generated_at": "2025-10-03T15:29:50+00:00",
            "table": "product_attribute",
            "operation": "add_index",
            "warning": null
        },
        {
            "id": "mig_c47eb1cd22fa",
            "sql": "ALTER TABLE `product_attribute` ADD CONSTRAINT `fk_product_attribute_product_id` FOREIGN KEY (`product_id`) REFERENCES `product` (`id`) ON DELETE CASCADE ON UPDATE CASCADE",
            "destructive": false,
            "generated_at": "2025-10-03T15:29:50+00:00",
            "table": "product_attribute",
            "operation": "add_fk",
            "warning": null
        }
    ]
}